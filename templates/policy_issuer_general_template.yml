prefixes:
  odrl: http://www.w3.org/ns/odrl/2/
  xsd: http://www.w3.org/2001/XMLSchema#
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns#
  occe: https://w3id.org/occe/
  dpv: https://w3id.org/dpv#
  obo: http://purl.obolibrary.org/obo/
  dc: http://purl.org/dc/terms/
  this: https://example.com/

sources:
  policy:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*]"

  permission:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*]"

  permission_assignee:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].assignee"

  permission_assignee_refinement:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].assignee.refinements.[*]"

  permission_target:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].target"

  permission_target_refinement:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].target.refinements.[*]"

  permission_action:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].actions.[*]"

  permission_action_refinement:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].actions.[*].refinements.[*]"

  permission_constraint:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].constraints.[*]"

  permission_duty:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].duties.[*]"

  permission_duty_action:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].duties.[*].actions.[*]"

  permission_duty_action_refinement:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].duties.[*].actions.[*].refinements.[*]"

  permission_duty_constraint:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].duties.[*].constraints.[*]"

  permission_duty_consequence:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].duties.[*].consequences.[*]"

  permission_duty_consequence_action:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].duties.[*].consequences.[*].actions.[*]"

  permission_duty_consequence_action_refinement:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.permissions.[*].duties.[*].consequences.[*].actions.[*].refinements.[*]"

  prohibition:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.prohibitions.[*]"

  prohibition_assignee:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.prohibitions.[*].assignees.[*]"

  prohibition_assignee_refinement:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.prohibitions.[*].assignees.[*].refinements.[*]"

  prohibition_target:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.prohibitions.[*].targets.[*]"

  prohibition_target_refinement:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.prohibitions.[*].targets.[*].refinements.[*]"

  obligation:
    access: data.json
    referenceFormulation: jsonpath
    iterator: "$.policies[*].rules.obligations.[*]"

mappings:
  policy:
    sources:
      - policy
    s: this:policies/$(id)
    po:
      - [a, $(type)~iri]
      - [odrl:profile, $(profile)~iri]
      - p: odrl:permission
        o:
          - mapping: permission
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From policy
                - [str2, $(policy_id)] # From permission
      - p: odrl:prohibition
        o:
          - mapping: prohibition
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From policy
                - [str2, $(policy_id)] # From rule

  permission:
    sources:
      - permission
    s: this:policies/$(policy_id)/permissions/$(id)
    po:
      - [odrl:assigner, $(assigner)~iri]
      - p: odrl:assignee
        o:
          - mapping: permission_assignee
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission
                - [str2, $(permission_id)] # From assignee
      - [odrl:target, $(targets_uri)~iri] # In case "target" is a URI
      - p: odrl:target # In case "target" is an object
        o:
          - mapping: permission_target
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission
                - [str2, $(permission_id)] # From target
      - p: odrl:action
        o:
          - mapping: permission_action
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission
                - [str2, $(permission_id)] # From action
      - p: odrl:duty
        o:
          - mapping: permission_duty
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission
                - [str2, $(permission_id)] # From duty
      - p: odrl:constraint
        o:
          - mapping: permission_constraint
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission
                - [str2, $(permission_id)] # From permission's constraint

  permission_assignee:
    sources:
      - permission_assignee
    s: this:policies/$(policy_id)/permissions/$(permission_id)/assignee
    po:
      - [a, $(type)~iri]
      - [odrl:uid, $(uid)~iri] # In case "assignee" has no refinement
      - [odrl:source, $(source)~iri] # In case "assignee" has one or more refinement(s)
      - p: odrl:refinement
        o:
          - mapping: permission_assignee_refinement
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission's assignee
                - [str2, $(permission_id)] # From permission assignee's refinement

  permission_assignee_refinement:
    sources:
      - permission_assignee_refinement
    s: this:policies/$(policy_id)/permissions/$(permission_id)/assignee/refinements/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]

  permission_target:
    sources:
      - permission_target
    s: this:policies/$(policy_id)/permissions/$(permission_id)/target
    po:
      - [a, $(type)~iri]
      - [odrl:uid, $(uid)~iri] # In case "target" has no refinement
      - [odrl:source, $(source)~iri] # In case "target" has one or more refinement(s)
      - p: odrl:refinement
        o:
          - mapping: permission_target_refinement
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission's target
                - [str2, $(permission_id)] # From permission target's refinement

  permission_target_refinement:
    sources:
      - permission_target_refinement
    s: this:policies/$(policy_id)/permissions/$(permission_id)/target/refinements/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]

  permission_action:
    sources:
      - permission_action
    s: this:policies/$(policy_id)/permissions/$(permission_id)/actions/$(id)
    po:
      - [rdf:value, $(value)~iri]
      - p: odrl:refinement
        o:
          - mapping: permission_action_refinement
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission's action
                - [str2, $(action_id)] # From permission action's refinement

  permission_action_refinement:
    sources:
      - permission_action_refinement
    s: this:policies/$(policy_id)/permissions/$(permission_id)/actions/$(action_id)/refinements/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]

  permission_duty:
    sources:
      - permission_duty
    s: this:policies/$(policy_id)/permissions/$(permission_id)/duties/$(id)
    po:
      - [odrl:target, $(target)~iri]
      - [odrl:assigner, $(assigner)~iri]
      - [odrl:assignee, $(assignee)~iri]
      - [odrl:attributedParty, $(attributed_party)~iri]
      - [odrl:attributingParty, $(attributing_party)~iri]
      - [odrl:compensatedParty, $(compensated_party)~iri]
      - [odrl:compensatingParty, $(compensating_party)~iri]
      - [odrl:consentedParty, $(consented_party)~iri]
      - [odrl:consentingParty, $(consenting_party)~iri]
      - [odrl:contractedParty, $(contracted_party)~iri]
      - [odrl:contractingParty, $(contracting_party)~iri]
      - [odrl:informedParty, $(informed_party)~iri]
      - [odrl:informingParty, $(informing_party)~iri]
      - [odrl:trackedParty, $(tracked_party)~iri]
      - [odrl:trackingParty, $(tracking_party)~iri]
      - p: odrl:action
        o:
          - mapping: permission_duty_action
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission's duty
                - [str2, $(permission_id)] # From permission duty's action
      - p: odrl:constraint
        o:
          - mapping: permission_duty_constraint
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission's duty
                - [str2, $(duty_id)] # From permission duty's constraint
      - p: odrl:consequence
        o:
          - mapping: permission_duty_consequence
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission's duty
                - [str2, $(duty_id)] # From permission duty's consequence

  permission_duty_action:
    sources:
      - permission_duty_action
    s: this:policies/$(policy_id)/permissions/$(permission_id)/duties/$(duty_id)/actions/$(id)
    po:
      - [rdf:value, $(value)~iri]
      - p: odrl:refinement
        o:
          - mapping: permission_duty_action_refinement
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission duty's action
                - [str2, $(action_id)] # From permission duty action's refinement

  permission_duty_action_refinement:
    sources:
      - permission_duty_action_refinement
    s: this:policies/$(policy_id)/permissions/$(permission_id)/duties/$(duty_id)/actions/$(action_id)/refinements/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]

  permission_duty_constraint:
    sources:
      - permission_duty_constraint
    s: this:policies/$(policy_id)/permissions/$(permission_id)/duties/$(duty_id)/constraints/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]

  permission_duty_consequence:
    sources:
      - permission_duty_consequence
    s: this:policies/$(policy_id)/permissions/$(permission_id)/duties/$(id)/consequences/$(id)
    po:
      - [odrl:target, $(target)~iri]
      - [odrl:assigner, $(assigner)~iri]
      - [odrl:assignee, $(assignee)~iri]
      - [odrl:attributedParty, $(attributed_party)~iri]
      - [odrl:attributingParty, $(attributing_party)~iri]
      - [odrl:compensatedParty, $(compensated_party)~iri]
      - [odrl:compensatingParty, $(compensating_party)~iri]
      - [odrl:consentedParty, $(consented_party)~iri]
      - [odrl:consentingParty, $(consenting_party)~iri]
      - [odrl:contractedParty, $(contracted_party)~iri]
      - [odrl:contractingParty, $(contracting_party)~iri]
      - [odrl:informedParty, $(informed_party)~iri]
      - [odrl:informingParty, $(informing_party)~iri]
      - [odrl:trackedParty, $(tracked_party)~iri]
      - [odrl:trackingParty, $(tracking_party)~iri]
      - p: odrl:action
        o:
          - mapping: permission_duty_consequence_action
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission duty consequence
                - [str2, $(consequence_id)] # From permission duty consequence's action

  permission_duty_consequence_action:
    sources:
      - permission_duty_consequence_action
    s: this:policies/$(policy_id)/permissions/$(permission_id)/duties/$(duty_id)/consequences/$(id)/actions/$(id)
    po:
      - [rdf:value, $(value)~iri]
      - p: odrl:refinement
        o:
          - mapping: permission_duty_consequence_action_refinement
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From permission duty consequence's action
                - [str2, $(action_id)] # From permission duty consequence action's refinement

  permission_duty_consequence_action_refinement:
    sources:
      - permission_duty_consequence_action_refinement
    s: this:policies/$(policy_id)/permissions/$(permission_id)/duties/$(duty_id)/consequences/$(id)/actions/$(id)/refinements/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]

  permission_constraint:
    sources:
      - permission_constraint
    s: this:policies/$(policy_id)/permissions/$(permission_id)/constraints/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]

  prohibition:
    sources:
      - prohibition
    s: this:policies/$(policy_id)/prohibitions/$(id)
    po:
      - p: odrl:assignee
        o:
          - mapping: prohibition_assignee
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From prohibition
                - [str2, $(prohibition_id)] # From assignee
      - p: odrl:target
        o:
          - mapping: prohibition_target
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From prohibition
                - [str2, $(prohibition_id)] # From target
      - [odrl:assigner, $(assigner)~iri]
      - [odrl:assignee, $(assignee)~iri]

  prohibition_assignee:
    sources:
      - prohibition_assignee
    s: this:policies/$(policy_id)/prohibitions/$(prohibition_id)/assignees/$(id)
    po:
      - [a, $(type)~iri]
      - [odrl:uid, $(uid)~iri] # In case "assignee" has no refinement
      - [odrl:source, $(source)~iri] # In case "assignee" has one or more refinement(s)
      - p: odrl:refinement
        o:
          - mapping: prohibition_assignee_refinement
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From prohibition's assignee
                - [str2, $(assignee_id)] # From prohibition assignee's refinement

  prohibition_assignee_refinement:
    sources:
      - prohibition_assignee_refinement
    s: this:policies/$(policy_id)/prohibitions/$(prohibition_id)/assignees/$(assignee_id)/refinements/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]

  prohibition_target:
    sources:
      - prohibition_target
    s: this:policies/$(policy_id)/prohibitions/$(prohibition_id)/targets/$(id)
    po:
      - [a, $(type)~iri]
      - [odrl:uid, $(uid)~iri] # In case "target" has no refinement
      - [odrl:source, $(source)~iri] # In case "target" has one or more refinement(s)
      - p: odrl:refinement
        o:
          - mapping: prohibition_target_refinement
            condition:
              function: equal
              parameters:
                - [str1, $(id)] # From prohibition's target
                - [str2, $(target_id)] # From prohibition target's refinement

  prohibition_target_refinement:
    sources:
      - prohibition_target_refinement
    s: this:policies/$(policy_id)/prohibitions/$(prohibition_id)/targets/$(target_id)/refinements/$(id)
    po:
      - [odrl:leftOperand, $(left_operand)~iri]
      - [odrl:operator, $(operator)~iri]
      - [odrl:rightOperand, $(right_operand_value_iri)~iri]
      - [odrl:rightOperand, $(right_operand_value_date), xsd:date]
      - [odrl:rightOperand, $(right_operand_value_dateTime), xsd:dateTime]
      - [odrl:rightOperand, $(right_operand_value_string), xsd:string]
      - [odrl:rightOperand, $(right_operand_value_float), xsd:float]
      - [odrl:rightOperand, $(right_operand_value_duration), xsd:duration]
      - [odrl:unit, $(unit)~iri]
